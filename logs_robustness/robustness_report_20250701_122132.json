{
  "test_session": {
    "start_time": "2025-07-01T12:21:26.221150",
    "test_count": 5,
    "success_count": 3,
    "failed_count": 2,
    "end_time": "2025-07-01T12:21:32.858209"
  },
  "tests": [
    {
      "test_name": "basic_functionality",
      "start_time": "2025-07-01T12:21:26.222150",
      "status": "failed",
      "details": {
        "module_import": "failed",
        "sharepoint_config": "found",
        "sharepoint_folders": 0
      },
      "errors": [
        "Erreur d'import module: cannot import name 'OrchestrateurDPGF' from 'orchestrate_dpgf_workflow_optimized' (D:\\CH4\\backend_JE\\orchestrate_dpgf_workflow_optimized.py)"
      ],
      "end_time": "2025-07-01T12:21:27.337657"
    },
    {
      "test_name": "excel_engine_detection",
      "start_time": "2025-07-01T12:21:27.339022",
      "status": "success",
      "details": {
        "detection_test.xls": "correct",
        "detection_test.xlsx": "correct",
        "detection_test.xlsm": "correct",
        "detection_test.unknown": "correct",
        "xlrd_available": "yes",
        "openpyxl_available": "yes"
      },
      "errors": [],
      "end_time": "2025-07-01T12:21:28.591220"
    },
    {
      "test_name": "log_analysis",
      "start_time": "2025-07-01T12:21:28.592317",
      "status": "success",
      "details": {
        "total_log_files": 364,
        "recent_files": [
          {
            "file": "logs\\dpgf_import_detailed_20250701_122127.log",
            "size": 0,
            "modified": "2025-07-01T12:21:27.450994"
          },
          {
            "file": "logs\\dpgf_import_20250701_122127.log",
            "size": 0,
            "modified": "2025-07-01T12:21:27.450639"
          },
          {
            "file": "logs\\identification_sharepoint_20250701_115940.log",
            "size": 27930,
            "modified": "2025-07-01T12:15:34.197468"
          },
          {
            "file": "logs\\dpgf_import_20250701_121529.log",
            "size": 15922,
            "modified": "2025-07-01T12:15:33.619556"
          },
          {
            "file": "logs\\dpgf_import_detailed_20250701_121529.log",
            "size": 8822,
            "modified": "2025-07-01T12:15:33.619103"
          },
          {
            "file": "logs\\identification_sharepoint_20250701_113443.log",
            "size": 27977,
            "modified": "2025-07-01T11:50:55.683384"
          },
          {
            "file": "logs\\dpgf_import_20250701_115053.log",
            "size": 15922,
            "modified": "2025-07-01T11:50:55.223296"
          },
          {
            "file": "logs\\dpgf_import_detailed_20250701_115053.log",
            "size": 8822,
            "modified": "2025-07-01T11:50:55.223296"
          },
          {
            "file": "logs\\identification_sharepoint_20250701_111630.log",
            "size": 4030,
            "modified": "2025-07-01T11:33:37.236277"
          },
          {
            "file": "logs\\dpgf_import_20250701_113335.log",
            "size": 774,
            "modified": "2025-07-01T11:33:36.763630"
          }
        ],
        "json_reports": [
          {
            "file": "reports\\workflow_progress_20250626_162941.json",
            "keys": [
              "metadata",
              "statistics",
              "detailed_results"
            ]
          },
          {
            "file": "reports\\workflow_progress_20250626_162954.json",
            "keys": [
              "metadata",
              "statistics",
              "detailed_results"
            ]
          },
          {
            "file": "reports\\workflow_progress_20250626_163034.json",
            "keys": [
              "metadata",
              "statistics",
              "detailed_results"
            ]
          },
          {
            "file": "reports\\workflow_progress_20250626_171501.json",
            "keys": [
              "metadata",
              "statistics",
              "detailed_results"
            ]
          },
          {
            "file": "reports\\workflow_progress_20250626_175924.json",
            "keys": [
              "metadata",
              "statistics",
              "detailed_results"
            ]
          },
          {
            "file": "reports\\workflow_progress_20250626_181000.json",
            "keys": [
              "metadata",
              "statistics",
              "detailed_results"
            ]
          },
          {
            "file": "reports\\workflow_progress_20250626_181208.json",
            "keys": [
              "metadata",
              "statistics",
              "detailed_results"
            ]
          },
          {
            "file": "reports\\workflow_progress_20250626_192712.json",
            "keys": [
              "metadata",
              "statistics",
              "detailed_results"
            ]
          },
          {
            "file": "reports\\workflow_progress_20250626_192917.json",
            "keys": [
              "metadata",
              "statistics",
              "detailed_results"
            ]
          },
          {
            "file": "reports\\workflow_progress_20250626_194515.json",
            "keys": [
              "metadata",
              "statistics",
              "detailed_results"
            ]
          },
          {
            "file": "reports\\workflow_progress_20250626_220849.json",
            "keys": [
              "metadata",
              "statistics",
              "detailed_results"
            ]
          },
          {
            "file": "reports\\workflow_progress_20250626_221421.json",
            "keys": [
              "metadata",
              "statistics",
              "detailed_results"
            ]
          },
          {
            "file": "reports\\workflow_progress_20250626_222404.json",
            "keys": [
              "metadata",
              "statistics",
              "detailed_results"
            ]
          },
          {
            "file": "reports\\workflow_progress_20250626_234742.json",
            "keys": [
              "metadata",
              "statistics",
              "detailed_results"
            ]
          },
          {
            "file": "reports\\workflow_progress_20250626_235830.json",
            "keys": [
              "metadata",
              "statistics",
              "detailed_results"
            ]
          },
          {
            "file": "reports\\workflow_progress_20250627_000809.json",
            "keys": [
              "metadata",
              "statistics",
              "detailed_results"
            ]
          },
          {
            "file": "reports\\workflow_progress_20250627_001916.json",
            "keys": [
              "metadata",
              "statistics",
              "detailed_results"
            ]
          },
          {
            "file": "reports\\workflow_progress_20250627_002005.json",
            "keys": [
              "metadata",
              "statistics",
              "detailed_results"
            ]
          },
          {
            "file": "reports\\workflow_progress_20250627_002218.json",
            "keys": [
              "metadata",
              "statistics",
              "detailed_results"
            ]
          },
          {
            "file": "reports\\workflow_progress_20250627_144002.json",
            "keys": [
              "metadata",
              "statistics",
              "detailed_results"
            ]
          },
          {
            "file": "reports\\workflow_progress_20250627_154831.json",
            "keys": [
              "metadata",
              "statistics",
              "detailed_results"
            ]
          },
          {
            "file": "reports\\workflow_progress_20250627_154857.json",
            "keys": [
              "metadata",
              "statistics",
              "detailed_results"
            ]
          },
          {
            "file": "reports\\workflow_progress_20250627_161558.json",
            "keys": [
              "metadata",
              "statistics",
              "detailed_results"
            ]
          },
          {
            "file": "reports\\workflow_progress_20250627_161623.json",
            "keys": [
              "metadata",
              "statistics",
              "detailed_results"
            ]
          },
          {
            "file": "reports\\workflow_progress_20250627_182520.json",
            "keys": [
              "metadata",
              "statistics",
              "detailed_results"
            ]
          },
          {
            "file": "reports\\workflow_progress_20250627_184052.json",
            "keys": [
              "metadata",
              "statistics",
              "detailed_results"
            ]
          },
          {
            "file": "reports\\workflow_progress_20250627_184135.json",
            "keys": [
              "metadata",
              "statistics",
              "detailed_results"
            ]
          },
          {
            "file": "reports\\workflow_progress_20250627_190508.json",
            "keys": [
              "metadata",
              "statistics",
              "detailed_results"
            ]
          },
          {
            "file": "reports\\workflow_progress_20250627_233328.json",
            "keys": [
              "metadata",
              "statistics",
              "detailed_results"
            ]
          },
          {
            "file": "reports\\workflow_progress_20250629_173749.json",
            "keys": [
              "metadata",
              "statistics",
              "detailed_results"
            ]
          },
          {
            "file": "reports\\workflow_progress_20250701_033000.json",
            "keys": [
              "metadata",
              "statistics",
              "detailed_results"
            ]
          },
          {
            "file": "reports\\workflow_progress_20250701_033110.json",
            "keys": [
              "metadata",
              "statistics",
              "detailed_results"
            ]
          },
          {
            "file": "reports\\workflow_progress_20250701_034718.json",
            "keys": [
              "metadata",
              "statistics",
              "detailed_results"
            ]
          },
          {
            "file": "reports\\workflow_progress_20250701_041428.json",
            "keys": [
              "metadata",
              "statistics",
              "detailed_results"
            ]
          },
          {
            "file": "reports\\workflow_progress_20250701_113337.json",
            "keys": [
              "metadata",
              "statistics",
              "detailed_results"
            ]
          },
          {
            "file": "reports\\workflow_progress_20250701_115055.json",
            "keys": [
              "metadata",
              "statistics",
              "detailed_results"
            ]
          },
          {
            "file": "reports\\workflow_progress_20250701_121534.json",
            "keys": [
              "metadata",
              "statistics",
              "detailed_results"
            ]
          }
        ]
      },
      "errors": [],
      "end_time": "2025-07-01T12:21:28.696136"
    },
    {
      "test_name": "error_handling",
      "start_time": "2025-07-01T12:21:28.697136",
      "status": "success",
      "details": {
        "invalid_config_test": {
          "return_code": 2,
          "handled_gracefully": false
        }
      },
      "errors": [],
      "end_time": "2025-07-01T12:21:30.800179"
    },
    {
      "test_name": "small_dataset_test",
      "start_time": "2025-07-01T12:21:30.802173",
      "status": "failed",
      "details": {
        "execution_time": 2.049752950668335,
        "return_code": 2,
        "stdout_length": 0,
        "stderr_length": 1319
      },
      "errors": [
        "Code de retour: 2",
        "Erreur stderr: usage: orchestrate_dpgf_workflow_optimized.py [-h] [--root-folder ROOT_FOLDER]\n                                              [--sharepoint-base SHAREPOINT_BASE]\n                                              [--folder-filters FOLDER_FILTERS]\n                                              [--max-folders MAX_FOLDERS]\n                                              [--max-files-per-folder MAX_FILES_PER_FOLDER]\n                                              [--min-confidence MIN_CONFIDENCE]\n             "
      ],
      "end_time": "2025-07-01T12:21:32.854094"
    }
  ]
}